<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tietovisa</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'DM Sans', 'Segoe UI', system-ui, sans-serif; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    button:focus { outline: 2px solid #60a5fa; outline-offset: 2px; }
    input[type="file"] { display: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const QUESTIONS_PER_GAME = 10;
    const SESSION_KEY = 'eurooppa-trivia-session';
    const CSV_FILENAME = 'questions.csv';
    const CONFIG_FILENAME = 'config.csv';

    // Default questions (fallback if questions.csv not loaded)
    const defaultQuestionsCSV = `question;optionA;optionB;correctAnswer;infoA;infoB
Kumpi joki on pidempi?;Tonava;Reinjoki;A;Tonava on Euroopan toiseksi pisin joki (2 850 km) ja virtaa 10 maan l√§pi.;Reinjoki on 1 233 km pitk√§ ja virtaa Alpeista Pohjanmereen.
Kumpi vuoristo on korkeampi?;Pyreneet;Alpit;B;Pyreneiden korkein huippu Aneto on 3 404 metri√§.;Alppien korkein huippu Mont Blanc on 4 809 metri√§.
Kumpi j√§rvi on suurempi pinta-alaltaan?;Laatokka;V√§nern;A;Laatokka on Euroopan suurin j√§rvi (17 700 km¬≤).;V√§nern on L√§nsi-Euroopan suurin j√§rvi (5 655 km¬≤).
Kumpi meri on syvempi?;V√§limeri;It√§meri;A;V√§limeren syvin kohta on 5 267 metri√§.;It√§meren keskisyvyys on vain 55 metri√§.
Kumpi vuori on korkeampi?;Matterhorn;Mont Blanc;B;Matterhorn on 4 478 metri√§ korkea ja tunnettu pyramidimaisesta muodostaan.;Mont Blanc on Alppien ja Euroopan korkein huippu (4 809 m).
Kumpi joki on pidempi?;Volga;Tonava;A;Volga on Euroopan pisin joki (3 531 km) ja laskee Kaspianmereen.;Tonava on Euroopan toiseksi pisin joki (2 850 km).
Kumpi saari on suurempi?;Iso-Britannia;Islanti;A;Iso-Britannia on Euroopan suurin saari (229 848 km¬≤).;Islanti on Euroopan toiseksi suurin saari (103 000 km¬≤).
Kumpi niemimaa on suurempi?;Skandinavian niemimaa;Iberian niemimaa;A;Skandinavian niemimaa on noin 750 000 km¬≤.;Iberian niemimaa on noin 582 000 km¬≤.
Kumpi j√§rvi on syvempi?;Saimaa;Hornindalsvatnet;B;Saimaan syvin kohta on 82 metri√§.;Hornindalsvatnet Norjassa on Euroopan syvin j√§rvi (514 m).
Kumpi vuoristo sijaitsee pohjoisempana?;Alpit;Skandit;B;Skandit ulottuvat Norjassa napapiirin pohjoispuolelle.;Alpit sijaitsevat Keski-Euroopassa 46. leveysasteen tienoilla.
Kumpi joki virtaa Suomen l√§pi?;Tornionjoki;Kemijoki;B;Tornionjoki muodostaa rajan Suomen ja Ruotsin v√§lille.;Kemijoki on kokonaan Suomen puolella ja Suomen pisin joki (550 km).
Kumpi maa rajoittuu Mustallemerelle?;Romania;Puola;A;Romania on yksi kuudesta Mustallemerelle rajoittuvasta maasta.;Puola rajoittuu It√§mereen, ei Mustallemerelle.
Kummassa maassa asuu enemm√§n ihmisi√§?;Ranska;Saksa;B;Ranskassa asuu yli 66 miljoonaa ihmist√§.;Saksassa asuu yli 84 miljoonaa ihmist√§.
Kumpi salmi yhdist√§√§ kaksi merta?;Gibraltarinsalmi;Englannin kanaali;A;Gibraltarinsalmi yhdist√§√§ V√§limeren ja Atlantin valtameren.;Englannin kanaali on meriv√§yl√§ Britannian ja Ranskan v√§lill√§.
Kummassa maassa asuu enemm√§n ihmisi√§?;Portugali;Hollanti;B;Portugalissa asuu yli 10 miljoonaa ihmist√§.;Hollannissa asuu yli 18 miljoonaa ihmist√§.
Kummassa maassa asuu enemm√§n ihmisi√§?;Espanja;Italia;B;Espanjassa asuu yli 49 miljoonaa ihmist√§.;Italiassa asuu yli 59 miljoonaa ihmist√§.
Kumpi vuoristo on vanhempi?;Skandit;Alpit;A;Skandit muodostuivat noin 400 miljoonaa vuotta sitten.;Alpit ovat nuorempia, noin 65 miljoonaa vuotta vanhoja.
Kumpi maa on maantieteellisesti pohjoisin?;Norja;Islanti;A;Norjan pohjoisin piste on 71¬∞ pohjoista leveytt√§.;Islannin pohjoisin piste on noin 66¬∞ pohjoista leveytt√§.
Kumpi joki virtaa Pariisissa?;Loire;Seine;B;Loire on Ranskan pisin joki (1 006 km) mutta ei virtaa Pariisissa.;Seine virtaa Pariisin l√§pi ja on 777 km pitk√§.
Kumpi on Belgian p√§√§kaupunki?;Bryssel;Varsova;A;Bryssel on Belgian p√§√§kaupunki.;Varsova on Puolan p√§√§kaupunki.
Kumpi on Norjan p√§√§kaupunki?;Bergen;Oslo;B;Oslo on Norjan p√§√§kaupunki.;Bergen on Norjan nelj√§nneksi suurin kaupunki.
Kumpi valtio sijaitsee vuoristossa?;Andorra;Monaco;A;Andorra sijaitsee Pyreneiden vuoristossa.;Monaco sijaitsee V√§limeren rannalla tasaisella alueella.
Kumpi meri on pienempi pinta-alaltaan?;Adrianmeri;It√§meri;B;Adrianmeri on noin 138 000 km¬≤ suuri pinta-alaltaan.;It√§meri on 377 000 km¬≤ suuri pinta-alaltaan.
Kumpi joki laskee Mustallemerelle?;Tonava;Volga;A;Tonava laskee Mustallemerelle Romanian kohdalla.;Volga laskee Kaspianmereen.
Kumpi vuori on tulivuori?;Etna;Mont Blanc;A;Etna Sisiliassa on Euroopan korkein aktiivinen tulivuori (3 357 m).;Mont Blanc ei ole tulivuori vaan graniitista muodostunut huippu.
Kumpi saari on l√§hemp√§n√§ Afrikkaa?;Sisilia;Sardinia;A;Sisilia on vain 140 km p√§√§ss√§ Tunisiasta.;Sardinia on noin 200 km p√§√§ss√§ Afrikan rannikosta.
Kumpi joki on pidempi?;Kemijoki;Loire;B;Kemijoki on Suomen pisin joki (noin 550 km).;Loire on Ranskan pisin joki (1 006 km) ja Kemijokea suurempi.
Kumpi niemimaa on etel√§isin?;Peloponnesoksen niemimaa;Iberian niemimaa;A;Peloponnesoksen etel√§k√§rki ulottuu 36¬∞ pohjoiseen leveyteen.;Iberian niemimaan etel√§k√§rki on 36¬∞ pohjoista leveytt√§.
Kumpi vuoristo on pidempi?;Alpit;Ural;B;Alppien kaari on noin 1 200 km pitk√§.;Uralin vuoristo on noin 2 500 km pitk√§.
Kumpi j√§rvi on suolaisempi?;Kaspianmeri;Laatokka;A;Kaspianmeri on suolainen j√§rvi (suolapitoisuus noin 1,2%).;Laatokka on makeavetinen j√§rvi.
Kumpi joki alkaa Alpeista?;Veikseli;Reinjoki;B;Veikseli saa alkunsa Karpaateilta Puolassa.;Reinjoki saa alkunsa Sveitsin Alpeista.
Kumpi saari on tihe√§mmin asuttu?;Malta;Islanti;A;Maltalla asuu noin 1 500 ihmist√§ per km¬≤.;Islannissa asuu vain noin 3,5 ihmist√§ per km¬≤.
Kumpi meri on Suomen rannikolla?;It√§meri;Pohjanmeri;A;Suomen rannikko on kokonaan It√§meren √§√§rell√§.;Pohjanmeri on Norjan, Tanskan ja Britannian v√§liss√§.
Kumpi vuoristo muodostaa rajan Euroopan ja Aasian v√§lille?;Ural;Kaukasus;A;Uralin vuoristo on perinteinen Euroopan ja Aasian raja.;Kaukasus on my√∂s rajalla, mutta Ural on tunnetumpi rajana.
Kumpi joki virtaa Lontoossa?;Thames;Severn;A;Thames virtaa Lontoon l√§pi ja on 346 km pitk√§.;Severn on Britannian pisin joki (354 km) mutta ei virtaa Lontoossa.
Kumpi j√§rvi sijaitsee Alpeilla?;Balatonj√§rvi;Comoj√§rvi;B;Balatonj√§rvi on Unkarissa tasangolla.;Comoj√§rvi on Pohjois-Italiassa Alppien kupeessa.
Kumpi vuori on korkeampi?;Mont Blanc;Elbrus;B;Mont Blanc on 4 809 m korkea.;Elbrus Kaukasuksella on 5 642 m korkea.
Kumpi joki on pidempi?;Dnepr;Reinjoki;A;Dnepr on 2 201 km pitk√§ ja virtaa Ukrainan l√§pi.;Reinjoki on 1 233 km pitk√§.
Kumpi niemimaa sijaitsee Pohjois-Euroopassa?;Jyllannin niemimaa;Apenniinien niemimaa;A;Jyllannin niemimaa muodostaa Tanskan mannerosan.;Apenniinien niemimaa on Italia.
Kumpi salmi erottaa Euroopan Aasiasta?;Messinin salmi;Bosporinsalmi;B;Messinin salmi erottaa Italian mantereesta Sisilian.;Bosporinsalmi Turkissa erottaa Euroopan ja Aasian.
Kumpi joki virtaa Wieniss√§?;Tonava;Reinjoki;A;Tonava virtaa Wienin l√§pi matkallaan Mustallemerelle.;Reinjoki virtaa Saksan ja Alankomaiden l√§pi.
Kumpi j√§rvi on Sveitsin ja Ranskan rajalla?;Genevenj√§rvi;Zurichinj√§rvi;A;Genevenj√§rvi on Sveitsin ja Ranskan rajalla.;Zurichinj√§rvi on kokonaan Sveitsiss√§.
Kumpi vuoristo on matalampi?;Alpit;Sudeettien vuoristo;B;Alppien korkein huippu on 4 809 metri√§.;Sudeettien korkein huippu on 1 603 metri√§.
Kumpi joki laskee It√§mereen?;Reinjoki;Veikseli;B;Reinjoki laskee Pohjanmereen.;Veikseli virtaa Puolan l√§pi ja laskee It√§mereen.
Kumpi saari on vulkaaninen?;Islanti;Iso-Britannia;A;Islanti sijaitsee Atlantin keskisel√§nteell√§ ja on vulkaanisesti aktiivinen.;Iso-Britannia ei ole vulkaanisesti aktiivinen.
Kumpi meri on syvempi?;It√§meri;Mustameri;B;It√§meren syvin kohta on 459 metri√§.;Mustanmeren syvin kohta on 2 212 metri√§.
Kumpi on Euroopan pienin maa v√§kiluvultaan?;Vatikaani;Luxemburg;A;Vatikaanissa asuu alle 1000 ihmist√§.;Luxemburgin v√§kiluku on yli 600 000.
Kumpi j√§rvi on suurempi?;Laatokka;Saimaa;A;Laatokka on Euroopan suurin j√§rvi (18 135 km¬≤).;Saimaa on 4 400 km¬≤ ja Suomen suurin j√§rvi.
Kumpi vuori on aktiivinen tulivuori?;Olympos;Vesuvius;B;Olympos-vuori Kreikassa ei ole tulivuori.;Vesuvius on aktiivinen tulivuori Napolin l√§hell√§.
Kumpi joki virtaa Budapestissa?;Tonava;Elbe;A;Tonava jakaa Budapestin Budaan ja Pestiin.;Elbe virtaa Saksan l√§pi.
Kumpi salmi on leve√§mpi?;Englannin kanaali;Gibraltarinsalmi;A;Englannin kanaalin kapein kohta on 34 km.;Gibraltarinsalmen kapein kohta on vain 14 km.
Kumpi maa on pinta-alaltaan suurempi?;It√§valta;Suomi;B;It√§valta on Euroopan maista 19. suurin.;Suomi on Euroopan maista kahdeksanneksi suurin.
Kumpi vuoristo on vanhempi?;Ural;Karpaatit;A;Ural muodostui noin 300 miljoonaa vuotta sitten.;Karpaatit ovat nuorempia, noin 30 miljoonaa vuotta vanhoja.
Kummassa maassa on enemm√§n j√§rvi√§?;Italia;Suomi;B;Suomessa on eniten yli 0,5 hehtaarin kokoisia j√§rvi√§ Euroopassa (yli 160 000).;Italiassa on monta kuuluisaa j√§rve√§, mutta lukum√§√§r√§lt√§√§n niit√§ on vain muutama tuhat.
Kumpi saari on idemp√§n√§?;Kypros;Kreeta;A;Kypros sijaitsee V√§limeren it√§osassa.;Kreeta on Kyproksen l√§nsipuolella.
Kumpi meri on l√§mpim√§mpi kes√§ll√§?;Adrianmeri;It√§meri;A;Adrianmeren l√§mp√∂tila nousee kes√§ll√§ yli 25¬∞C.;It√§meri l√§mpenee kes√§ll√§ noin 17-20¬∞C.
Kumpi joki virtaa kolmen p√§√§kaupungin l√§pi?;Reinjoki;Tonava;B;Reinjoki ei virtaa yhdenk√§√§n p√§√§kaupungin l√§pi.;Tonava virtaa Wienin, Bratislavan ja Budapestin l√§pi.
Kumpi vuoristo muodostaa Espanjan ja Ranskan rajan?;Pyreneet;Alpit;A;Pyreneet ulottuvat Atlantilta V√§limerelle Espanjan ja Ranskan rajalla.;Alpit ovat Ranskan ja Italian sek√§ Sveitsin rajalla.
Kumpi j√§rvi on kapeampi?;Comoj√§rvi;Gardasj√§rvi;A;Comoj√§rvi on vain 4,5 km leveimmill√§√§n.;Gardasj√§rvi on jopa 17 km leve√§.
Mik√§ on Italian p√§√§kaupunki;Milano;Rooma;B;Milano on Italian toiseksi suurin kaupunki.;Rooma on Italian p√§√§kaupunki ja my√∂s Italian suurin.
Kumpi saari on Kreikalle kuuluva?;Kreeta;Korsika;A;Kreeta on Kreikan suurin saari.;Korsika kuuluu Ranskalle.
Kumpi niemimaista on l√§ntisempi?;Iberian niemimaa;Balkanin niemimaa;A;Iberian niemimaa on Euroopan lounaiskolkka.;Balkanin niemimaa on Kaakkois-Euroopassa.
Kumpi vuori on Kreikan korkein?;Olympos;Parnassos;A;Olympos on Kreikan korkein vuori (2 917 m).;Parnassos on 2 457 m korkea.
Mik√§ on Euroopan etel√§isin maa?;Portugali;Kreikka;B;Portugali on Euroopan l√§ntisin maa.;Kreikan etel√§isimm√§t saaret, kuten Gavdos, ovat Euroopan etel√§isin osa.
Kumpi maa on Euroopassa;Afganistan;Puola;B;Afganistan kuuluu etel√§-Aasiaan.;Puola on osa Eurooppaa.
Kumpi meri on suolaisempi?;V√§limeri;It√§meri;A;V√§limeren suolapitoisuus on noin 38 promillea.;It√§meren suolapitoisuus on vain 7-8 promillea.
Kumpi vuoristo on korkeampi?;Kaukasus;Karpaatit;A;Kaukasuksen korkein huippu Elbrus on 5 642 m.;Karpaattien korkein huippu on 2 655 m.
Kumpi on Ranskan naapurimaa?;Puola;Espanja;B;Puolan ja Ranskan v√§liss√§ on Saksa.;Espanjalla ja Ranskalla on noin 450 km yhteist√§ rajaa.
Kumpi saari on pohjoisempi?;Huippuvuoret;Islanti;A;Huippuvuoret (Svalbard) ulottuvat l√§hes 81¬∞ pohjoiseen.;Islanti ulottuu noin 66¬∞ pohjoiseen.
Kumpi j√§rvi on Italiassa?;Balatonj√§rvi;Maggiorej√§rvi;B;Balatonj√§rvi on Unkarissa.;Maggiorej√§rvi on Pohjois-Italiassa Alpeilla.
Kumpi on Kreikan p√§√§kaupunki;Ateena;Zagreb;A;Ateena on Kreikan suurin kaupunki ja my√∂s maan p√§√§kaupunki.;Zagreb on Kroatian p√§√§kaupunki.
Kumpi vuori sijaitsee Italiassa?;Etna;Teide;A;Etna on Sisiliassa Italiassa.;Teide on Kanariansaarilla Espanjassa.
Kumpi meri on Euroopan ja Afrikan v√§liss√§?;V√§limeri;Mustameri;A;V√§limeri erottaa Euroopan ja Afrikan.;Mustameri on Euroopan ja Aasian v√§liss√§.
Kummalla maalla on enemm√§n rajanaapureita?;Sveitsi;Saksa;B;Sveitsill√§ on viisi rajanaapuria.;Saksalla on yhdeks√§n rajanaapuria.
Kumpi joki alkaa Sveitsin Alpeista?;Rh√¥ne;Elbe;A;Rh√¥ne saa alkunsa Sveitsin Alpeista ja laskee V√§limerelle.;Elbe saa alkunsa T≈°ekist√§.
Kumpi on Sveitsin P√§√§kaupunki;Bern;Berliini;A;Bern on Sveitsin p√§√§kaupunki.;Berliini on Saksan p√§√§kaupunki.
Kumpi niemimaa on pienempi?;Iberian niemimaa;Jyllannin niemimaa;B;Iberian niemimaa on noin 582 000 km¬≤.;Jyllannin niemimaa on noin 29 775 km¬≤.
Kumpi joki virtaa Berliiniss√§?;Spree;Elbe;A;Spree virtaa Berliinin l√§pi ja on 400 km pitk√§.;Elbe virtaa Hampurin l√§pi.
Kumpi on Viron P√§√§kaupunki;Tallinna;Riika;A;Tallinna on Viron p√§√§kaupunki.;Riika on Latvian p√§√§kaupunki.
Kumpi on Tanskan P√§√§kaupunki;Oslo;K√∂√∂penhamina;B;Oslo on Norjan p√§√§kaupunki.;K√∂√∂penhamina on Tanskan p√§√§kaupunki.
Kumpi vuoristo on T≈°ekiss√§?;Sudeettien vuoristo;Tatrat;A;Sudeettien vuoristo on T≈°ekin ja Puolan rajalla.;Tatrat ovat Puolan ja Slovakian rajalla.
Kumpi joki on Britannian pisin?;Thames;Severn;B;Thames on 346 km pitk√§.;Severn on 354 km pitk√§.
Kumpi meri yhdist√§√§ It√§meren Pohjanmereen?;Kattegat;Bosporinsalmi;A;Kattegat ja Skagerrak yhdist√§v√§t It√§meren Pohjanmereen.;Bosporinsalmi yhdist√§√§ Mustanmeren Marmaranmereen.
Kumpi on suurempi kaupunki pinta-alaltaan?;Pariisi;Rovaniemi;B;Pariisi on v√§kiluvultaan Euroopan Union suurin metropolialue.;Rovaniemi on pinta-alaltaan sek√§ Suomen ett√§ Euroopan suurin kaupunki.
Kummassa maassa on enemm√§n asukkaita?;Suomi;Ruotsi;B;Suomessa asuu noin 5,6 miljoonaa ihmist√§.;Ruotsissa asuu noin 10,7 miljoonaa ihmist√§.
Kummassa maassa on enemm√§n asukkaita?;Norja;Tanska;B;Norjassa asuu noin 5,6 miljoonaa ihmist√§.;Tanskassa asuu noin 6 miljoonaa ihmist√§.
Kummassa maassa on enemm√§n asukkaita?;Iso-Britannia;Tsekki;A;Iso-Britanniassa asuu noin 69 miljoonaa ihmist√§.;Tsekiss√§ asuu noin 10,6 miljoonaa ihmist√§.
Kumpi j√§rvi on Ruotsissa?;V√§ttern;Onega;A;V√§ttern on Ruotsin toiseksi suurin j√§rvi.;Onega on Ven√§j√§ll√§.
Kumpi vuoristo on Italian selk√§ranka?;Alpit;Apenniinit;B;Alpit ovat Pohjois-Italian rajalla.;Apenniinit ulottuvat l√§pi Italian niemimaan.
Kumpi joki virtaa K√∂lniss√§?;Reinjoki;Elbe;A;Reinjoki virtaa K√∂lnin l√§pi Saksassa.;Elbe virtaa Hampurin ja Dresdenin l√§pi.
Kumpi meri on matalampi?;Asovanmeri;Adrianmeri;A;Asovanmeren keskisyvyys on vain 7 metri√§.;Adrianmeren keskisyvyys on 252 metri√§.
Kumpi j√§rvi on Suomessa?;Onega;P√§ij√§nne;B;Onega on j√§rvi Ven√§j√§ll√§.;P√§ij√§nne on Suomen toiseksi suurin j√§rvi.
Kumpi vuoristo on Romanian p√§√§asiallinen vuoristo?;Karpaatit;Alpit;A;Karpaatit kaartuvat Romanian l√§pi.;Alpit eiv√§t ulotu Romaniaan.
Kumpi joki on Ven√§j√§n pisin?;Ural-joki;Volga;B;Ural-joki on 2 428 km pitk√§.;Volga on 3 531 km pitk√§ ja Euroopan pisin joki.
Kumpi saari on Tanskalle kuuluva?;Gr√∂nlanti;Islanti;A;Gr√∂nlanti on Tanskan itsehallintoalue.;Islanti on itsen√§inen valtio.
Kumpi j√§rvi on It√§vallan rajalla?;Comoj√§rvi;Bodenj√§rvi;B;Comoj√§rvi on kokonaan Italiassa.;Bodenj√§rvi on It√§vallan, Saksan ja Sveitsin rajalla.
Kumpi maa on pinta-alaltaan suurempi?;Ranska;Saksa;A;Ranska on pinta-alaltaan 643 801 km¬≤.;Saksa on pinta-alaltaan 357 022 km¬≤.
Kumpi maa on pinta-alaltaan suurempi?;Ranska;Puola;A;Ranska on pinta-alaltaan Euroopan kolmanneksi suurin.;Puola on pinta-alaltaan Euroopan yhdeks√§nneksi suurin.
Kumpi vuori on Espanjan korkein?;Teide;Mulhac√©n;A;Teide Teneriffalla on 3 718 m korkea.;Mulhac√©n on Espanjan mantereella korkein (3 479 m).`;

    // Default UI texts (fallback if config.csv not loaded)
    const defaultTexts = {
      title: 'Euroopan Maantiede',
      subtitle: 'Tietovisa',
      welcomeTitle: 'Tervetuloa tietovisaan!',
      welcomeText: 'Testatkaa tietonne Euroopan maista, kaupungeista, joista, vuoristoista, j√§rvist√§ ja merist√§.',
      startButton: 'Aloita peli',
      filePickerTitle: 'Valitse kysymystiedosto',
      filePickerText: 'Valitse CSV-tiedosto, jossa on tietovisan kysymykset.',
      filePickerButton: 'Valitse CSV-tiedosto',
      backButton: 'Takaisin',
      nextButton: 'Seuraava kysymys',
      showResultsButton: 'N√§yt√§ tulokset',
      correctText: 'Oikein!',
      wrongText: 'V√§√§rin!',
      gameOverTitle: 'Peli p√§√§ttyi!',
      playAgainButton: 'Pelaa uudelleen',
      backToStartButton: 'Alkuun',
      loadDifferentFile: 'Lataa eri kysymystiedosto',
      questionLabel: 'Kysymys',
      correctLabel: 'oikein'
    };

    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    function loadSession() {
      try {
        const saved = sessionStorage.getItem(SESSION_KEY);
        if (saved) return JSON.parse(saved);
      } catch (e) {}
      return null;
    }

    function saveSession(session) {
      try {
        sessionStorage.setItem(SESSION_KEY, JSON.stringify(session));
      } catch (e) {}
    }

    function clearSession() {
      sessionStorage.removeItem(SESSION_KEY);
    }

    function getEncouragingMessage(correct, total) {
      const percentage = (correct / total) * 100;
      if (percentage === 100) return { emoji: 'üèÜ', message: 'T√§ydellist√§! Olette maantieteen mestareita!' };
      if (percentage >= 80) return { emoji: 'üåü', message: 'Erinomaista ty√∂t√§! Tunnette aiheen todella hyvin!' };
      if (percentage >= 60) return { emoji: 'üëè', message: 'Hyv√§√§ ty√∂t√§! Opitte paljon uutta t√§n√§√§n!' };
      if (percentage >= 40) return { emoji: 'üí™', message: 'Hienoa yritt√§mist√§! Aiheessa on paljon opittavaa!' };
      return { emoji: 'üåç', message: 'Harjoitelkaa lis√§√§!' };
    }

    // Parse CSV with auto-detect delimiter (comma or semicolon)
    function parseCSV(text) {
      // Detect delimiter by checking first line
      const firstLine = text.split('\n')[0];
      const delimiter = firstLine.includes(';') ? ';' : ',';
      return Papa.parse(text, { header: true, skipEmptyLines: true, delimiter });
    }

    function TriviaGame() {
      const [allQuestions, setAllQuestions] = useState([]);
      const [texts, setTexts] = useState(defaultTexts);
      const [gameState, setGameState] = useState('loading');
      const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
      const [selectedQuestions, setSelectedQuestions] = useState([]);
      const [correctAnswers, setCorrectAnswers] = useState(0);
      const [selectedAnswer, setSelectedAnswer] = useState(null);
      const [isCorrect, setIsCorrect] = useState(null);
      const [usedQuestionIndices, setUsedQuestionIndices] = useState([]);
      const [questionsLoaded, setQuestionsLoaded] = useState(false);
      const fileInputRef = useRef(null);

      // Load config texts
      useEffect(() => {
        fetch(CONFIG_FILENAME)
          .then(response => {
            if (!response.ok) throw new Error('Config not found');
            return response.text();
          })
          .then(csvText => {
            const results = parseCSV(csvText);
            if (results.data && results.data.length > 0) {
              const configTexts = { ...defaultTexts };
              results.data.forEach(row => {
                if (row.key && row.value) {
                  configTexts[row.key] = row.value;
                }
              });
              setTexts(configTexts);
            }
          })
          .catch(() => {
            console.log('Using default texts');
          });
      }, []);

      // Load questions (try external file first, then use embedded default)
      const loadDefaultQuestions = () => {
        const results = parseCSV(defaultQuestionsCSV);
        if (results.data && results.data.length > 0) {
          setAllQuestions(results.data);
          setQuestionsLoaded(true);
        }
      };

      useEffect(() => {
        fetch(CSV_FILENAME)
          .then(response => {
            if (!response.ok) throw new Error('Questions not found');
            return response.text();
          })
          .then(csvText => {
            const results = parseCSV(csvText);
            if (results.data && results.data.length > 0) {
              setAllQuestions(results.data);
              setQuestionsLoaded(true);
            } else {
              // Use default questions if external file is empty
              loadDefaultQuestions();
            }

            // Check for existing session
            const savedSession = loadSession();
            if (savedSession && savedSession.selectedQuestions && savedSession.selectedQuestions.length > 0) {
              setSelectedQuestions(savedSession.selectedQuestions);
              setCurrentQuestionIndex(savedSession.currentQuestionIndex || 0);
              setCorrectAnswers(savedSession.correctAnswers || 0);
              setUsedQuestionIndices(savedSession.usedQuestionIndices || []);

              if (savedSession.currentQuestionIndex >= QUESTIONS_PER_GAME) {
                setGameState('finished');
              } else if (savedSession.isAnswered) {
                setSelectedAnswer(savedSession.selectedAnswer);
                setIsCorrect(savedSession.isCorrect);
                setGameState('answered');
              } else {
                setGameState('playing');
              }
            } else {
              setGameState('start');
            }
          })
          .catch(() => {
            // Use default embedded questions when fetch fails
            loadDefaultQuestions();
            setGameState('start');
          });
      }, []);

      // Load questions from selected file
      const loadQuestionsFromFile = (file) => {
        Papa.parse(file, {
          header: true,
          skipEmptyLines: true,
          complete: (results) => {
            // Auto-detect delimiter wasn't used by Papa.parse for File, so try again if needed
            if (results.data && results.data.length > 0) {
              // Check if data looks valid (has expected columns)
              const firstRow = results.data[0];
              if (firstRow.question || firstRow.optionA) {
                setAllQuestions(results.data);
                setQuestionsLoaded(true);
                setGameState('start');
              } else {
                // Try with semicolon delimiter
                Papa.parse(file, {
                  header: true,
                  skipEmptyLines: true,
                  delimiter: ';',
                  complete: (results2) => {
                    if (results2.data && results2.data.length > 0) {
                      setAllQuestions(results2.data);
                      setQuestionsLoaded(true);
                      setGameState('start');
                    }
                  }
                });
              }
            }
          }
        });
      };

      const handleFileSelect = (event) => {
        const file = event.target.files[0];
        if (file) {
          loadQuestionsFromFile(file);
        }
      };

      useEffect(() => {
        if (gameState !== 'loading' && gameState !== 'start' && gameState !== 'needFile') {
          saveSession({
            selectedQuestions,
            currentQuestionIndex,
            correctAnswers,
            usedQuestionIndices,
            selectedAnswer,
            isCorrect,
            isAnswered: gameState === 'answered'
          });
        }
      }, [gameState, selectedQuestions, currentQuestionIndex, correctAnswers, usedQuestionIndices, selectedAnswer, isCorrect]);

      const handleStartGame = () => {
        if (!questionsLoaded) {
          setGameState('needFile');
        } else {
          startNewGame();
        }
      };

      const startNewGame = () => {
        let availableIndices = allQuestions.map((_, i) => i).filter(i => !usedQuestionIndices.includes(i));
        if (availableIndices.length < QUESTIONS_PER_GAME) {
          availableIndices = allQuestions.map((_, i) => i);
          setUsedQuestionIndices([]);
        }
        const shuffled = shuffleArray(availableIndices);
        const pickedIndices = shuffled.slice(0, QUESTIONS_PER_GAME);
        const picked = pickedIndices.map(i => allQuestions[i]);

        setSelectedQuestions(picked);
        setUsedQuestionIndices(prev => [...prev, ...pickedIndices]);
        setCurrentQuestionIndex(0);
        setCorrectAnswers(0);
        setSelectedAnswer(null);
        setIsCorrect(null);
        setGameState('playing');
      };

      const handleAnswer = (answer) => {
        const currentQuestion = selectedQuestions[currentQuestionIndex];
        const correct = answer === currentQuestion.correctAnswer;
        setSelectedAnswer(answer);
        setIsCorrect(correct);
        if (correct) setCorrectAnswers(prev => prev + 1);
        setGameState('answered');
      };

      const handleNext = () => {
        const nextIndex = currentQuestionIndex + 1;
        if (nextIndex >= QUESTIONS_PER_GAME) {
          setGameState('finished');
        } else {
          setCurrentQuestionIndex(nextIndex);
          setSelectedAnswer(null);
          setIsCorrect(null);
          setGameState('playing');
        }
      };

      const handlePlayAgain = () => {
        clearSession();
        startNewGame();
      };

      const handleBackToStart = () => {
        clearSession();
        setGameState('start');
        setSelectedQuestions([]);
        setCurrentQuestionIndex(0);
        setCorrectAnswers(0);
        setSelectedAnswer(null);
        setIsCorrect(null);
      };

      const currentQuestion = selectedQuestions[currentQuestionIndex];
      const answeredProgress = gameState === 'answered' ? (currentQuestionIndex + 1) / QUESTIONS_PER_GAME : currentQuestionIndex / QUESTIONS_PER_GAME;

      const containerStyle = {
        minHeight: '100vh',
        background: 'linear-gradient(135deg, #1a2a3a 0%, #0d1520 50%, #1a2530 100%)',
        fontFamily: "'DM Sans', 'Segoe UI', system-ui, sans-serif",
        color: '#e8e6e3',
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        justifyContent: 'center',
        padding: '2rem',
        boxSizing: 'border-box',
        position: 'relative',
        overflow: 'hidden'
      };

      const bgDecor = {
        position: 'absolute', top: 0, left: 0, right: 0, bottom: 0,
        background: 'radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.08) 0%, transparent 50%), radial-gradient(circle at 50% 50%, rgba(139, 92, 246, 0.05) 0%, transparent 60%)',
        pointerEvents: 'none'
      };

      const gridPattern = {
        position: 'absolute', top: 0, left: 0, right: 0, bottom: 0,
        backgroundImage: 'linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px)',
        backgroundSize: '60px 60px',
        pointerEvents: 'none'
      };

      return (
        <div style={containerStyle}>
          <div style={bgDecor} />
          <div style={gridPattern} />

          <input
            type="file"
            ref={fileInputRef}
            accept=".csv"
            onChange={handleFileSelect}
          />

          <div style={{ position: 'relative', zIndex: 1, width: '100%', maxWidth: '900px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
            <div style={{ marginBottom: '2rem', textAlign: 'center' }}>
              <h1 style={{ fontSize: '2.5rem', fontWeight: 700, letterSpacing: '-0.02em', margin: 0, background: 'linear-gradient(135deg, #60a5fa 0%, #34d399 100%)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', backgroundClip: 'text' }}>
                {texts.title}
              </h1>
              <p style={{ fontSize: '1rem', color: 'rgba(255,255,255,0.5)', margin: '0.5rem 0 0 0', letterSpacing: '0.1em', textTransform: 'uppercase' }}>
                {texts.subtitle}
              </p>
            </div>

            {gameState === 'loading' && (
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1rem', padding: '4rem' }}>
                <div style={{ width: '24px', height: '24px', border: '3px solid rgba(96, 165, 250, 0.3)', borderTopColor: '#60a5fa', borderRadius: '50%', animation: 'spin 1s linear infinite' }} />
                <span style={{ color: 'rgba(255,255,255,0.6)' }}>Ladataan...</span>
              </div>
            )}

            {gameState === 'start' && (
              <div style={{ background: 'rgba(255,255,255,0.03)', backdropFilter: 'blur(20px)', borderRadius: '24px', padding: '3rem', border: '1px solid rgba(255,255,255,0.08)', textAlign: 'center', maxWidth: '500px', width: '100%' }}>
                <div style={{ fontSize: '4rem', marginBottom: '1.5rem' }}>üåç</div>
                <h2 style={{ fontSize: '1.75rem', fontWeight: 600, marginBottom: '1rem', color: '#fff' }}>{texts.welcomeTitle}</h2>
                <p style={{ fontSize: '1.1rem', color: 'rgba(255,255,255,0.6)', lineHeight: 1.6, marginBottom: '0.5rem' }}>
                  {texts.welcomeText}
                </p>
                {questionsLoaded ? (
                  <p style={{ fontSize: '0.95rem', color: 'rgba(255,255,255,0.5)', marginBottom: '2rem' }}>
                    ({allQuestions.length} kysymyst√§ ladattu)
                  </p>
                ) : (
                  <p style={{ fontSize: '0.95rem', color: '#f59e0b', marginBottom: '2rem' }}>
                    ‚ö†Ô∏è Valitse ensin kysymystiedosto alta
                  </p>
                )}
                <button
                  onClick={questionsLoaded ? startNewGame : null}
                  disabled={!questionsLoaded}
                  style={{
                    background: questionsLoaded ? 'linear-gradient(135deg, #3b82f6 0%, #10b981 100%)' : 'rgba(255,255,255,0.1)',
                    color: questionsLoaded ? 'white' : 'rgba(255,255,255,0.4)',
                    border: 'none',
                    borderRadius: '16px',
                    padding: '1.25rem 3rem',
                    fontSize: '1.25rem',
                    fontWeight: 600,
                    cursor: questionsLoaded ? 'pointer' : 'not-allowed',
                    boxShadow: questionsLoaded ? '0 4px 20px rgba(59, 130, 246, 0.3)' : 'none',
                    letterSpacing: '0.02em'
                  }}>
                  {texts.startButton}
                </button>
                <button
                  onClick={() => fileInputRef.current?.click()}
                  style={{ display: 'block', margin: '1.5rem auto 0', background: 'rgba(255,255,255,0.1)', color: 'white', border: '1px solid rgba(255,255,255,0.2)', borderRadius: '12px', padding: '0.75rem 1.5rem', fontSize: '0.95rem', fontWeight: 500, cursor: 'pointer' }}
                >
                  üìÅ {questionsLoaded ? texts.loadDifferentFile : texts.filePickerButton}
                </button>
              </div>
            )}

            {gameState === 'needFile' && (
              <div style={{ background: 'rgba(255,255,255,0.03)', backdropFilter: 'blur(20px)', borderRadius: '24px', padding: '3rem', border: '1px solid rgba(255,255,255,0.08)', textAlign: 'center', maxWidth: '550px', width: '100%' }}>
                <div style={{ fontSize: '4rem', marginBottom: '1.5rem' }}>üìÇ</div>
                <h2 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '1rem', color: '#fff' }}>{texts.filePickerTitle}</h2>
                <p style={{ fontSize: '1rem', color: 'rgba(255,255,255,0.6)', lineHeight: 1.6, marginBottom: '1.5rem' }}>
                  {texts.filePickerText}
                </p>
                <button
                  onClick={() => fileInputRef.current?.click()}
                  style={{ background: 'linear-gradient(135deg, #3b82f6 0%, #10b981 100%)', color: 'white', border: 'none', borderRadius: '16px', padding: '1.25rem 2.5rem', fontSize: '1.1rem', fontWeight: 600, cursor: 'pointer', boxShadow: '0 4px 20px rgba(59, 130, 246, 0.3)' }}
                >
                  üìÅ {texts.filePickerButton}
                </button>
                <button
                  onClick={() => setGameState('start')}
                  style={{ display: 'block', margin: '1.5rem auto 0', background: 'rgba(255,255,255,0.1)', color: 'white', border: '1px solid rgba(255,255,255,0.2)', borderRadius: '12px', padding: '0.75rem 2rem', fontSize: '0.95rem', fontWeight: 500, cursor: 'pointer' }}
                >
                  ‚Üê {texts.backButton}
                </button>
              </div>
            )}

            {(gameState === 'playing' || gameState === 'answered') && currentQuestion && (
              <>
                <div style={{ width: '100%', marginBottom: '2rem' }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
                    <span style={{ fontSize: '0.9rem', color: 'rgba(255,255,255,0.5)', fontWeight: 500 }}>{texts.questionLabel} {currentQuestionIndex + 1} / {QUESTIONS_PER_GAME}</span>
                    <span style={{ fontSize: '0.9rem', color: '#34d399', fontWeight: 600, display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                      <span style={{ fontSize: '1.1rem' }}>‚úì</span> {correctAnswers} {texts.correctLabel}
                    </span>
                  </div>
                  <div style={{ height: '8px', background: 'rgba(255,255,255,0.1)', borderRadius: '4px', overflow: 'hidden' }}>
                    <div style={{ height: '100%', width: `${answeredProgress * 100}%`, background: 'linear-gradient(90deg, #3b82f6, #10b981)', borderRadius: '4px', transition: 'width 0.5s ease' }} />
                  </div>
                  <div style={{ display: 'flex', gap: '8px', marginTop: '1rem', justifyContent: 'center' }}>
                    {Array.from({ length: QUESTIONS_PER_GAME }).map((_, i) => {
                      let bg = 'rgba(255,255,255,0.15)';
                      if (i < currentQuestionIndex) bg = 'rgba(255,255,255,0.3)';
                      else if (i === currentQuestionIndex && gameState === 'answered') bg = isCorrect ? '#10b981' : '#ef4444';
                      else if (i === currentQuestionIndex) bg = '#3b82f6';
                      return <div key={i} style={{ width: '12px', height: '12px', borderRadius: '50%', background: bg, transition: 'all 0.3s ease' }} />;
                    })}
                  </div>
                </div>

                <div style={{ background: 'rgba(255,255,255,0.04)', backdropFilter: 'blur(20px)', borderRadius: '24px', padding: '2.5rem', border: '1px solid rgba(255,255,255,0.08)', width: '100%', textAlign: 'center' }}>
                  <h2 style={{ fontSize: '2rem', fontWeight: 600, marginBottom: '2.5rem', color: '#fff', lineHeight: 1.3 }}>{currentQuestion.question}</h2>

                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1.5rem', marginBottom: gameState === 'answered' ? '2rem' : 0 }}>
                    {['A', 'B'].map((option) => {
                      const isSelected = selectedAnswer === option;
                      const isCorrectAnswer = currentQuestion.correctAnswer === option;
                      const showResult = gameState === 'answered';
                      let borderColor = 'rgba(255,255,255,0.1)';
                      let bgColor = 'rgba(255,255,255,0.03)';
                      if (showResult) {
                        if (isCorrectAnswer) { borderColor = '#10b981'; bgColor = 'rgba(16, 185, 129, 0.15)'; }
                        else if (isSelected) { borderColor = '#ef4444'; bgColor = 'rgba(239, 68, 68, 0.15)'; }
                      }
                      return (
                        <button key={option} onClick={() => gameState === 'playing' && handleAnswer(option)} disabled={gameState === 'answered'}
                          style={{ background: bgColor, border: `2px solid ${borderColor}`, borderRadius: '16px', padding: '2rem 1.5rem', cursor: gameState === 'playing' ? 'pointer' : 'default', transition: 'all 0.3s ease', textAlign: 'center', position: 'relative' }}>
                          <div style={{ position: 'absolute', top: '-12px', left: '50%', transform: 'translateX(-50%)', background: showResult && isCorrectAnswer ? '#10b981' : showResult && isSelected && !isCorrectAnswer ? '#ef4444' : '#3b82f6', color: 'white', width: '28px', height: '28px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.9rem', fontWeight: 700 }}>{option}</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 600, color: '#fff', marginBottom: showResult ? '1rem' : 0 }}>{option === 'A' ? currentQuestion.optionA : currentQuestion.optionB}</div>
                          {showResult && <div style={{ fontSize: '1rem', color: 'rgba(255,255,255,0.7)', lineHeight: 1.5, marginTop: '0.5rem', padding: '0.75rem', background: 'rgba(0,0,0,0.2)', borderRadius: '8px' }}>{option === 'A' ? currentQuestion.infoA : currentQuestion.infoB}</div>}
                        </button>
                      );
                    })}
                  </div>

                  {gameState === 'answered' && (
                    <div style={{ marginTop: '1.5rem', animation: 'fadeIn 0.3s ease' }}>
                      <div style={{ display: 'inline-flex', alignItems: 'center', gap: '0.75rem', padding: '1rem 2rem', borderRadius: '12px', background: isCorrect ? 'rgba(16, 185, 129, 0.15)' : 'rgba(239, 68, 68, 0.15)', border: `1px solid ${isCorrect ? 'rgba(16, 185, 129, 0.3)' : 'rgba(239, 68, 68, 0.3)'}`, marginBottom: '1.5rem' }}>
                        <span style={{ fontSize: '1.5rem' }}>{isCorrect ? '‚úÖ' : '‚ùå'}</span>
                        <span style={{ fontSize: '1.25rem', fontWeight: 600, color: isCorrect ? '#34d399' : '#f87171' }}>{isCorrect ? texts.correctText : texts.wrongText}</span>
                      </div>
                      <button onClick={handleNext} style={{ display: 'block', width: '100%', background: 'linear-gradient(135deg, #3b82f6 0%, #10b981 100%)', color: 'white', border: 'none', borderRadius: '16px', padding: '1.25rem 2rem', fontSize: '1.25rem', fontWeight: 600, cursor: 'pointer', boxShadow: '0 4px 20px rgba(59, 130, 246, 0.3)' }}>
                        {currentQuestionIndex + 1 >= QUESTIONS_PER_GAME ? texts.showResultsButton : texts.nextButton} ‚Üí
                      </button>
                    </div>
                  )}
                </div>
              </>
            )}

            {gameState === 'finished' && (() => {
              const { emoji, message } = getEncouragingMessage(correctAnswers, QUESTIONS_PER_GAME);
              return (
                <div style={{ background: 'rgba(255,255,255,0.04)', backdropFilter: 'blur(20px)', borderRadius: '24px', padding: '3rem', border: '1px solid rgba(255,255,255,0.08)', textAlign: 'center', maxWidth: '600px', width: '100%' }}>
                  <div style={{ fontSize: '5rem', marginBottom: '1rem' }}>{emoji}</div>
                  <h2 style={{ fontSize: '2rem', fontWeight: 700, marginBottom: '0.5rem', color: '#fff' }}>{texts.gameOverTitle}</h2>
                  <div style={{ fontSize: '3.5rem', fontWeight: 700, background: 'linear-gradient(135deg, #60a5fa 0%, #34d399 100%)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', backgroundClip: 'text', margin: '1.5rem 0' }}>{correctAnswers} / {QUESTIONS_PER_GAME}</div>
                  <p style={{ fontSize: '1.25rem', color: 'rgba(255,255,255,0.7)', marginBottom: '2.5rem', lineHeight: 1.5 }}>{message}</p>
                  <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', flexWrap: 'wrap' }}>
                    <button onClick={handlePlayAgain} style={{ background: 'linear-gradient(135deg, #3b82f6 0%, #10b981 100%)', color: 'white', border: 'none', borderRadius: '16px', padding: '1.25rem 2.5rem', fontSize: '1.1rem', fontWeight: 600, cursor: 'pointer', boxShadow: '0 4px 20px rgba(59, 130, 246, 0.3)' }}>{texts.playAgainButton}</button>
                    <button onClick={handleBackToStart} style={{ background: 'rgba(255,255,255,0.1)', color: 'white', border: '1px solid rgba(255,255,255,0.2)', borderRadius: '16px', padding: '1.25rem 2.5rem', fontSize: '1.1rem', fontWeight: 600, cursor: 'pointer' }}>{texts.backToStartButton}</button>
                  </div>
                </div>
              );
            })()}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<TriviaGame />);
  </script>
</body>
</html>
